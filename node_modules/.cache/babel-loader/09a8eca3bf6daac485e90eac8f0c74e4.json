{"ast":null,"code":"import _toConsumableArray from\"C:/Users/jo/software-projects/geotop-a/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _regeneratorRuntime from\"C:/Users/jo/software-projects/geotop-a/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/jo/software-projects/geotop-a/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:/Users/jo/software-projects/geotop-a/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import React,{useState,useEffect}from\"react\";// nodejs library that concatenates classes\nimport classNames from\"classnames\";// @material-ui/core components\nimport{makeStyles}from\"@material-ui/core/styles\";// @material-ui/icons\n// core components\nimport GridContainer from\"../../../components/Grid/GridContainer.js\";import GridItem from\"../../../components/Grid/GridItem.js\";import styles from\"../../../assets/jss/material-kit-react/views/landingPageSections/teamStyle.js\";import MenuOpen from'@material-ui/icons/MenuOpen';import{db}from'../../../ConfigFirebase';var useStyles=makeStyles(styles);export default function ListSpeakersSection(){var classes=useStyles();var keywords_aux={};// keywords_aux sera un diccionario indexado por todas las keywords que almacena listas de objetos \n// del tipo [talk.id, surname, year]\nvar _useState=useState({}),_useState2=_slicedToArray(_useState,2),keywords=_useState2[0],setKeywords=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),keywordsListByLetter=_useState4[0],setKeywordsListByLatter=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),lettersInKeywords=_useState6[0],setLettersInKeywords=_useState6[1];var _useState7=useState({}),_useState8=_slicedToArray(_useState7,2),visitLetters=_useState8[0],setVisitLetters=_useState8[1];var _useState9=useState({}),_useState10=_slicedToArray(_useState9,2),speakersById=_useState10[0],setSpeakersById=_useState10[1];useEffect(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var speakers;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:speakers={};_context3.next=3;return db.collection('speakers').get().then(function(querySnapshot){querySnapshot.forEach(/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(doc){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:speakers[doc.id]=doc.data().surname;case 1:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref2.apply(this,arguments);};}());}).catch(function(error){alert(\"Some speakers cannot load.\");});case 3:_context3.next=5;return db.collection(\"talks\").get().then(function(querySnapshot){querySnapshot.forEach(/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(doc){var keys,keys_len,i,idx;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:keys=doc.data().keywords;keys_len=keys.length;for(i=0;i<keys_len;i++){// Checo si encuentro una keyword nueva\nif(!(keys[i]in keywords_aux)){keywords_aux[keys[i]]=[];}idx=doc.data().speaker;keywords_aux[keys[i]].push([doc.id,speakers[idx],doc.data().date.toDate().getFullYear(),doc.data().video]);}case 3:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref3.apply(this,arguments);};}());}).catch(function(error){alert(\"Cannot load some talk\");});case 5:setKeywords(keywords_aux);case 6:case\"end\":return _context3.stop();}}},_callee3);})),[]);// Al modificar speakers list con el contenido se actualiza\nuseEffect(function(){handleLettersInKeyWords();},[keywords]);// Función que revisa las letras que existen para hacer listas\nfunction handleLettersInKeyWords(){var letterSet=new Set();var visitLetters={};var keywordsWithLetter={};for(var k in keywords){var letter=k.charAt(0).toUpperCase();letterSet.add(letter);visitLetters[letter]=false;keywordsWithLetter[letter]=[];}for(var k in keywords){var letter=k.charAt(0).toUpperCase();var copy={};copy[k]=keywords[k];keywordsWithLetter[letter].push(copy);}var auxLetterSet=_toConsumableArray(letterSet);auxLetterSet.sort();setLettersInKeywords(auxLetterSet);setVisitLetters(visitLetters);setKeywordsListByLatter(keywordsWithLetter);}function listWithLetter(letter){var listItems=keywordsListByLetter[letter].map(function(keyword){return/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(\"h5\",{style:{fontSize:'20px',fontStyle:'normal'},children:Object.keys(keyword).map(function(k){var result='';var first=true;return/*#__PURE__*/_jsxs(_Fragment,{children:[k,\" \",/*#__PURE__*/_jsx(\"br\",{}),keywords[k].map(function(data){return/*#__PURE__*/_jsxs(_Fragment,{children:[first?first=false:',',\" \",data[1],\" \",/*#__PURE__*/_jsx(\"a\",{href:data[3],target:\"_blank\",children:data[2]}),\"  \"]});}),\" \"]});})})});});return/*#__PURE__*/_jsx(\"ul\",{style:{listStyleType:'none'},children:listItems});}function listAlphabetical(){var _this=this;var listItems=lettersInKeywords.map(function(letter){return/*#__PURE__*/_jsx(\"li\",{style:{listStyleType:'none'},children:/*#__PURE__*/_jsxs(\"h1\",{className:classes.title,children:[letter,\" \",/*#__PURE__*/_jsx(MenuOpen,{onClick:onclickLetter.bind(_this,letter),style:{cursor:'pointer'}}),\" \",visitLetters[letter]?listWithLetter(letter):null]})});});return/*#__PURE__*/_jsx(\"ul\",{style:{textAlign:'left'},children:listItems});}var _useState11=useState(0),_useState12=_slicedToArray(_useState11,2),count=_useState12[0],setCount=_useState12[1];function onclickLetter(letter){var newVisit=visitLetters;newVisit[letter]=!newVisit[letter];setVisitLetters(newVisit);setCount(count+1);}return/*#__PURE__*/_jsx(\"div\",{className:classes.section,children:listAlphabetical()});}","map":{"version":3,"sources":["C:/Users/jo/software-projects/geotop-a/src/views/ListKeywordsPage/Sections/ListKeywordsSection.js"],"names":["React","useState","useEffect","classNames","makeStyles","GridContainer","GridItem","styles","MenuOpen","db","useStyles","ListSpeakersSection","classes","keywords_aux","keywords","setKeywords","keywordsListByLetter","setKeywordsListByLatter","lettersInKeywords","setLettersInKeywords","visitLetters","setVisitLetters","speakersById","setSpeakersById","speakers","collection","get","then","querySnapshot","forEach","doc","id","data","surname","catch","error","alert","keys","keys_len","length","i","idx","speaker","push","date","toDate","getFullYear","video","handleLettersInKeyWords","letterSet","Set","keywordsWithLetter","k","letter","charAt","toUpperCase","add","copy","auxLetterSet","sort","listWithLetter","listItems","map","keyword","fontSize","fontStyle","Object","result","first","listStyleType","listAlphabetical","title","onclickLetter","bind","cursor","textAlign","count","setCount","newVisit","section"],"mappings":"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","sourcesContent":["import React, {useState, useEffect} from \"react\";\r\n// nodejs library that concatenates classes\r\nimport classNames from \"classnames\";\r\n// @material-ui/core components\r\nimport { makeStyles } from \"@material-ui/core/styles\";\r\n\r\n// @material-ui/icons\r\n\r\n// core components\r\nimport GridContainer from \"../../../components/Grid/GridContainer.js\";\r\nimport GridItem from \"../../../components/Grid/GridItem.js\";\r\n\r\nimport styles from \"../../../assets/jss/material-kit-react/views/landingPageSections/teamStyle.js\";\r\nimport MenuOpen from '@material-ui/icons/MenuOpen';\r\n\r\nimport {db} from '../../../ConfigFirebase';\r\n\r\nconst useStyles = makeStyles(styles);\r\n\r\nexport default function     ListSpeakersSection(){\r\n    const classes = useStyles();\r\n    let keywords_aux = {};\r\n    // keywords_aux sera un diccionario indexado por todas las keywords que almacena listas de objetos \r\n    // del tipo [talk.id, surname, year]\r\n\r\n    const [keywords, setKeywords] = useState({});\r\n    const [keywordsListByLetter,setKeywordsListByLatter] = useState([]);\r\n    const [lettersInKeywords, setLettersInKeywords] = useState([]);\r\n    const [visitLetters, setVisitLetters] = useState({});\r\n    const [speakersById,setSpeakersById] = useState({});\r\n    \r\n    useEffect(async()=>{\r\n        \r\n        var speakers = {};\r\n        await db.collection('speakers').get()\r\n        .then(function(querySnapshot){\r\n            querySnapshot.forEach(async function(doc){\r\n                speakers[doc.id] = doc.data().surname;\r\n            })\r\n        })\r\n        .catch(function(error){\r\n            alert(\"Some speakers cannot load.\");\r\n        });\r\n\r\n        await db.collection(\"talks\").get()\r\n        .then(function(querySnapshot){\r\n            querySnapshot.forEach(async function(doc){\r\n                let keys = doc.data().keywords;\r\n                let keys_len = keys.length;\r\n                for(let i=0; i<keys_len; i++){\r\n                    // Checo si encuentro una keyword nueva\r\n                    if(!(keys[i] in keywords_aux)){\r\n                        keywords_aux[keys[i]] = []\r\n                    }\r\n                    var idx = doc.data().speaker;\r\n                    keywords_aux[keys[i]].push(\r\n                        [doc.id, speakers[idx], doc.data().date.toDate().getFullYear(), doc.data().video]\r\n                    );   \r\n                }\r\n            });\r\n        })\r\n        .catch(function(error){\r\n            alert(\"Cannot load some talk\")\r\n        });\r\n        setKeywords(keywords_aux);\r\n    },[]);\r\n\r\n    // Al modificar speakers list con el contenido se actualiza\r\n    useEffect(() => {\r\n        handleLettersInKeyWords();\r\n    },[keywords]);\r\n\r\n    // Función que revisa las letras que existen para hacer listas\r\n    function handleLettersInKeyWords(){\r\n        let letterSet = new Set();\r\n        let visitLetters = {};\r\n        let keywordsWithLetter = {};\r\n        for(var k in keywords){\r\n            var letter = k.charAt(0).toUpperCase();\r\n            letterSet.add(letter);\r\n            visitLetters[letter] = false;\r\n            keywordsWithLetter[letter] = [];\r\n        }\r\n        for(var k in keywords){\r\n            var letter = k.charAt(0).toUpperCase() ;\r\n            var copy = {};\r\n            copy[k] = keywords[k];\r\n            keywordsWithLetter[letter].push(copy);\r\n        }\r\n        var auxLetterSet = [...letterSet];\r\n        auxLetterSet.sort();\r\n        setLettersInKeywords(auxLetterSet);\r\n        setVisitLetters(visitLetters);\r\n        setKeywordsListByLatter(keywordsWithLetter); \r\n    }  \r\n\r\n    function listWithLetter(letter){\r\n    \r\n        const listItems = keywordsListByLetter[letter].map(keyword =>\r\n            <li> \r\n            <h5 style={{fontSize: '20px', fontStyle:'normal'}}> \r\n                {Object.keys(keyword).map(function(k) {\r\n                    let result = '';\r\n                    let first = true;    \r\n                    \r\n                    return (\r\n                       <> \r\n                       {k} <br/>\r\n                       {keywords[k].map((data) =>{ \r\n                        return (\r\n                            <>{first ? first=false : ',' } {data[1]} <a href={data[3]} target=\"_blank\">{data[2]}</a>  </>\r\n                        )\r\n                       })} </>    \r\n                    )})}\r\n            </h5>\r\n            </li>\r\n        );\r\n        \r\n        return (\r\n            <ul style={{listStyleType:'none'}}>\r\n                {listItems}\r\n            </ul>\r\n        );\r\n    }\r\n\r\n    function listAlphabetical(){\r\n        const listItems = lettersInKeywords.map(letter => \r\n                <li\r\n                    style={{listStyleType:'none'}} > \r\n                    <h1 className={classes.title}> \r\n                        {letter} <MenuOpen\r\n                        onClick={onclickLetter.bind(this, letter)}\r\n                        style={{cursor: 'pointer'}}\r\n                        /> {visitLetters[letter] ? listWithLetter(letter) : null}\r\n                    </h1>\r\n                </li>\r\n        );\r\n        return (\r\n            <ul style={{textAlign: 'left'}}>{listItems}</ul>\r\n        );\r\n    }\r\n\r\n    const [count, setCount] = useState(0);\r\n\r\n    function onclickLetter(letter){\r\n        let newVisit = visitLetters;\r\n        newVisit[letter] = !newVisit[letter];\r\n        setVisitLetters(newVisit);\r\n        setCount(count+1);\r\n    }\r\n\r\n    return(\r\n        <div className={classes.section} > \r\n            {listAlphabetical()}\r\n        </div>\r\n    );\r\n}"]},"metadata":{},"sourceType":"module"}